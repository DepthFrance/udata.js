<!DOCTYPE html>
<html lang="en-us">
  <head>
    <meta charset="UTF-8">
    <title>Metaclic by datakode</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" type="text/css" href="stylesheets/normalize.css" media="screen">
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:400,700' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/github-light.css" media="screen">
  </head>
  <body>
    <section class="page-header">
      <h1 class="project-name">Metaclic</h1>
      <h2 class="project-tagline">Librairie JS d&#39;intégration du catalogue data.gouv.fr</h2>
      <a href="https://github.com/datakode/metaclic" class="btn">View on GitHub</a>
      <a href="https://github.com/datakode/metaclic/zipball/master" class="btn">Download .zip</a>
      <a href="https://github.com/datakode/metaclic/tarball/master" class="btn">Download .tar.gz</a>
    </section>

    <section class="main-content">
      <h1>
<a id="metaclic" class="anchor" href="#metaclic" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Metaclic</h1>

<p>Librairie JS d'intégration du catalogue data.gouv.fr (<a href="https://www.data.gouv.fr">https://www.data.gouv.fr</a>)</p>

<h2>
<a id="démo" class="anchor" href="#d%C3%A9mo" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>démo</h2>

<p><a href="http://datakode.github.io/metaclic/exemples/exemple.html">http://datakode.github.io/metaclic/exemples/exemple.html</a></p>

<h2>
<a id="utilisation" class="anchor" href="#utilisation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>utilisation</h2>

<pre><code>       &lt;script&gt;window.jQuery || document.write("&lt;script src='https://cdnjs.cloudflare.com/ajax/libs/jquery/2.2.0/jquery.min.js'&gt;&lt;\/script&gt;")&lt;/script&gt;

        &lt;!-- chargement feuille de style bootstrap --&gt;
        &lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.css"&gt;
        &lt;!-- chargement feuille de style font-awesome --&gt;
        &lt;link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.5.0/css/font-awesome.min.css"&gt;

        &lt;div
          class="Metaclic-data"
          data-organizations="534fffb3a3a7292c64a78129,551959f6c751df6682057c91,534fffb9a3a7292c64a7814f,558bef88c751df1fd9a453b9,55896c18c751df5864a453b9,558bf578c751df2f9ea453ea,534fff4ea3a7292c64a77cab"
          data-organization="551959f6c751df6682057c91"
          data-q="eau"
          data-facets="all"
          data-page_size="5"&gt;
        &lt;/div&gt;
</code></pre>

<p>paramètres:</p>

<ul>
<li>data-organizations: ID des organisations proposées dans le menu déroulant</li>
<li>data-organization: ID de l'organisation selectionnée (optionnel)</li>
<li>data-q: recherche initiale (optionnel)</li>
<li>data-page_size: nombre de résultat par page (optionnel)</li>
<li>data-sort: tri des résulats, valeurs possibles ['title','created','last_modified','followers','reuses',false] si false le menu est masqué (optionnel, default: title)</li>
<li>data-sharelink: boolean si true, affiche le lien de partage (optionnel, default: false)</li>
</ul>

<p>l'ensemble des paramètres de l'API Metaclic <a href="https://www.data.gouv.fr/fr/apidoc/#!/datasets/list_datasets">GET /datasets/</a> sont utilisables</p>

<p>ex: <code>data-tag='transport'</code></p>

<h2>
<a id="personnalisation" class="anchor" href="#personnalisation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>personnalisation</h2>

<p>Vous pouvez personnaliser l'affichage en utilisant des templates <a href="http://handlebarsjs.com/">handlebars</a>
voici les identifiants et templates par défaut utilisés:</p>

<ul>
<li>
<strong>metaclic_template_datasetsForm</strong> (affichage du formulaire de recherche)</li>
</ul>

<pre><code>&lt;script id='metaclic_template_datasetsForm' type="text/x-handlebars-template"&gt;
        &lt;div class="datasetsForm"&gt;
                &lt;form action="" method="get"&gt;
                        &lt;div&gt;&lt;label&gt;&lt;/label&gt;&lt;input type="text" name="q" value="{{q}}" placeholder="Rechercher des données" class="form-control"&gt;&lt;/input&gt;&lt;/div&gt;
                        {{#ifCount orgs "&gt;" 1 }}
                        &lt;div&gt;
                        {{else}}
                        &lt;div class="hidden"&gt;
                                {{/ifCount}}
                                &lt;label&gt;Organisme&lt;/label&gt;&lt;select name="organizations" class="form-control"&gt;
                                {{#each orgs}}
                                {{#ifCond id "==" ../organization}}
                                &lt;option value="{{id}}" selected&gt;{{name}}&lt;/option&gt;
                                {{else}}
                                &lt;option value="{{id}}"&gt;{{name}}&lt;/option&gt;
                                {{/ifCond}}
                                {{/each}}
                        &lt;/select&gt;&lt;/div&gt;
                &lt;/form&gt;
        &lt;/div&gt;
        &lt;br&gt;
&lt;/script&gt;
</code></pre>

<ul>
<li>
<strong>metaclic_template_datasets</strong> (affichage de la liste résultat)</li>
</ul>

<pre><code>&lt;script id='metaclic_template_datasets' type="text/x-handlebars-template"&gt;
        &lt;div class="result-count"&gt;{{ total }} résultat(s)&lt;/div&gt;
        {{#ifCond sort "!=" false}}
        &lt;div class="result-sort form-inline"&gt;&lt;label&gt;Trier par&lt;/label&gt;
                &lt;select name="sort" class="form-control"&gt;
                    {{#each sortTypes}}

                    {{#ifCond id "==" ../sort}}
                    &lt;option value="{{id}}" selected&gt;{{name}}&lt;/option&gt;
                    {{else}}
                    &lt;option value="{{id}}"&gt;{{name}}&lt;/option&gt;
                    {{/ifCond}}

                    {{/each}}
                &lt;/select&gt;
                &lt;a href="#" class="sortdirection"&gt;
                    {{#ifCond sortDesc "==" true}}
                    &lt;i class="fa fa-sort-alpha-desc"&gt;&lt;/i&gt;
                    {{else}}
                    &lt;i class="fa fa-sort-alpha-asc"&gt;&lt;/i&gt;
                    {{/ifCond}}
                &lt;/a&gt;
        &lt;/div&gt;
        {{/ifCond}}
        &lt;ul class="search-results"&gt;
                {{#each data}}
                &lt;li class="search-result dataset-result" data-dataset="{{id}}"&gt;
                    &lt;a href="{{ page }}" title="{{  organization.name }}"  data-dataset="{{id}}"&gt;

                        &lt;div class="result-logo pull-left"&gt;
                            &lt;img alt="" src="{{organization.logo}}" width="70" height="70"&gt;
                        &lt;/div&gt;
                        {{#if organization.public_service }}
                        &lt;img alt="certified" class="certified" rel="popover" data-title="{{_ 'certified_public_service'}}" data-content="{{_ 'the_identity_of_this_public_service_public_is_certified_by_etalab'}}" data-container="body" data-trigger="hover"/&gt;
                        {{/if}}
                        &lt;div class="result-body ellipsis-dot is-truncated" style="word-wrap: break-word;"&gt;
                            &lt;h4 class="result-title"&gt;{{title}}&lt;/h4&gt;

                            &lt;div class="result-description"&gt;
                                {{mdshort description 128}}
                            &lt;/div&gt;
                        &lt;/div&gt;

                        &lt;/a&gt;
                        &lt;ul class="list-inline result-infos"&gt;
                                {{#if temporal_coverage }}
                                &lt;li&gt;
                                    &lt;span class="" rel="tooltip"
                                    data-placement="top" data-container="body"
                                    title="{{_ 'temporal_coverage'}}"&gt;
                                    &lt;span class="fa fa-calendar fa-fw"&gt;&lt;/span&gt;
                                    {{dt temporal_coverage.start format='L' }} {{_ 'to'}} {{dt temporal_coverage.end format='L' }}
                                    &lt;/span&gt;
                                &lt;/li&gt;
                                {{/if}}

                                {{#if frequency }}
                                &lt;li&gt;
                                        &lt;span class="" rel="tooltip"
                                        data-placement="top" data-container="body"
                                        title="{{_ 'Update frequency' }}"&gt;
                                        &lt;span class="fa fa-clock-o fa-fw"&gt;&lt;/span&gt;
                                        {{_ frequency }}
                                        &lt;/span&gt;
                                &lt;/li&gt;
                                {{/if}}

                                {{#if spatial.territories }}
                                &lt;li&gt;
                                        &lt;span class="" rel="tooltip"
                                        data-placement="top" data-container="body"
                                        title="{{_ 'Spatial coverage'}}"&gt;
                                        &lt;span class="fa fa-map-marker fa-fw"&gt;&lt;/span&gt;
                                        {{_ spatial.territories.0.name }}
                                &lt;/span&gt;
                                &lt;/li&gt;
                                {{/if}}

                                {{#if spatial.granularity }}
                                &lt;li&gt;
                                        &lt;span class="" rel="tooltip"
                                        data-placement="top" data-container="body"
                                        title="{{_ 'Spatial granularity'}}"&gt;
                                        &lt;span class="fa fa-bullseye fa-fw"&gt;&lt;/span&gt;
                                        {{_ spatial.granularity }}
                                &lt;/span&gt;
                                &lt;/li&gt;
                                {{/if}}

                                &lt;li&gt;
                                        &lt;span class="" rel="tooltip"
                                        data-placement="top" data-container="body"
                                        title="{{_ 'Reuses'}}"&gt;
                                        &lt;span class="fa fa-retweet fa-fw"&gt;&lt;/span&gt;
                                        {{default metrics.reuses 0 }}
                                &lt;/span&gt;
                                &lt;/li&gt;

                                &lt;li&gt;
                                        &lt;span class="" rel="tooltip"
                                        data-placement="top" data-container="body"
                                        title="{{_ 'Followers'}}"&gt;
                                        &lt;span class="fa fa-star fa-fw"&gt;&lt;/span&gt;
                                        {{default metrics.followers 0 }}
                                &lt;/span&gt;
                                &lt;/li&gt;

                        &lt;/ul&gt;
                &lt;/li&gt;
                {{/each}}
        &lt;/ul&gt;
        &lt;div class="text-center"&gt;
                &lt;div class="pagination"&gt;
                    {{{ paginate page total page_size }}}
                &lt;/div&gt;
        &lt;/div&gt;
&lt;/script&gt;
</code></pre>

<ul>
<li>
<strong>metaclic_template_dataset</strong> (affichage de la fiche)</li>
</ul>

<pre><code>&lt;script id='metaclic_template_dataset' type="text/x-handlebars-template"&gt;
        &lt;div class="dataset" data-dataset="{{id}}"&gt;

                &lt;div class='dataset-info'&gt;
                    &lt;blockquote&gt;{{md description }}&lt;/blockquote&gt;
                    {{#if extras.remote_url}}
                    &lt;a class="site_link" href="{{extras.remote_url}}" target=_blank&gt;
                        Voir le site original
                &lt;/a&gt;
                {{/if}}
                &lt;p class="published_on"&gt;
                        {{_ 'published_on' }} {{dt created_at}}
                        {{_ 'and_modified_on'}} {{dt last_modified}}
                        {{_ 'by'}} &lt;a title="{{organization.name}}" href="{{organization.page}}"&gt;{{organization.name}}&lt;/a&gt;
                &lt;/p&gt;
        &lt;/div&gt;

        &lt;div class="resources-list"&gt;
                &lt;h3&gt;{{_ 'Resources'}}&lt;/h3&gt;
                {{#each resources}}
                &lt;div data-checkurl="/api/1/datasets/checkurl/" itemtype="http://schema.org/DataDownload" itemscope="itemscope" id="resource-{{id}}"&gt;

                        &lt;a href="{{url}}" data-size="{{filesize}}" data-format="{{format}}" data-title="{{title}}" data-id="{{id}}" itemprop="url" target=_blank&gt;
                            &lt;h4&gt;
                                &lt;span data-format="{{format}}"&gt;
                                    {{format}}
                                &lt;/span&gt;
                                {{title}}
                                &lt;p&gt;Dernière modification le {{dt last_modified}}&lt;/p&gt;
                            &lt;/h4&gt;
                        &lt;/a&gt;
                &lt;/div&gt;
        {{/each}}
        &lt;/div&gt;

        &lt;div class="meta"&gt;
                &lt;div class="producer"&gt;
                        &lt;h3&gt;{{_ 'Producer'}}&lt;/h3&gt;
                        &lt;a title="{{organization.name}}" href="{{organization.page}}"&gt;
                            &lt;img class="organization-logo producer" alt="{{organization.name}}" src="{{fulllogo organization.logo}}"&gt;&lt;br&gt;
                            &lt;span class="name"&gt;{{organization.name}}&lt;/span&gt;
                        &lt;/a&gt;
                &lt;/div&gt;


                &lt;div class="info"&gt;
                        &lt;h3&gt;{{_ 'Informations'}}&lt;/h3&gt;
                        &lt;ul&gt;
                                &lt;li title="{{_ 'License'}}" rel="tooltip"&gt;
                                        &lt;i class="fa fa-copyright"&gt;&lt;/i&gt;
                                        &lt;!--a href="http://opendatacommons.org/licenses/odbl/summary/"--&gt;{{_ license}}&lt;!--/a--&gt;
                                &lt;/li&gt;
                                &lt;li title="{{_ 'Frequency'}}" rel="tooltip"&gt;
                                        &lt;span class="fa fa-clock-o"&gt;&lt;/span&gt;
                                        {{_ frequency}}
                                &lt;/li&gt;
                                &lt;li title="{{_ 'Spatial granularity'}}"  rel="tooltip"&gt;
                                        &lt;span class="fa fa-bullseye"&gt;&lt;/span&gt;
                                        {{_ spatial.granularity}}
                                &lt;/li&gt;
                        &lt;/ul&gt;
                        &lt;ul class="spatial_zones"&gt;
                                {{#each spatial.zones}}
                                &lt;li data-zone="{{.}}"&gt;{{.}}&lt;/li&gt;
                                {{/each}}
                        &lt;/ul&gt;
                        &lt;ul class="tags"&gt;
                                {{#each tags}}
                                &lt;li&gt;&lt;a title="{{.}}" href="https://www.data.gouv.fr/fr/search/?tag={{.}}"&gt;{{.}}&lt;/a&gt;&lt;/li&gt;
                                {{/each}}
                        &lt;/ul&gt;
                &lt;/div&gt;

        &lt;/div&gt;
&lt;/script&gt;
</code></pre>

<h2>
<a id="exemple-de-personnalisation" class="anchor" href="#exemple-de-personnalisation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>exemple de personnalisation</h2>

<p><a href="http://datakode.github.io/metaclic/exemples/exemple2.html">http://datakode.github.io/metaclic/exemples/exemple2.html</a></p>

<h2>
<a id="integration-carte-simple" class="anchor" href="#integration-carte-simple" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Integration carte simple</h2>

<p><a href="http://datakode.github.io/metaclic/exemples/exemple_map.html">http://datakode.github.io/metaclic/exemples/exemple_map.html</a></p>

<p><a href="http://datakode.github.io/metaclic/exemples/exemple_map2.html">http://datakode.github.io/metaclic/exemples/exemple_map2.html</a></p>

<p><a href="http://datakode.github.io/metaclic/exemples/exemple_map3.html">http://datakode.github.io/metaclic/exemples/exemple_map3.html</a></p>

      <footer class="site-footer">
        <span class="site-footer-owner"><a href="https://github.com/datakode/metaclic">Metaclic</a> is maintained by <a href="https://github.com/datakode">datakode</a>.</span>

        <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the <a href="https://github.com/jasonlong/cayman-theme">Cayman theme</a> by <a href="https://twitter.com/jasonlong">Jason Long</a>.</span>
      </footer>

    </section>

  
  </body>
</html>
